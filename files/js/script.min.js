var FOS=window.FOS||{};FOS.utils=FOS.utils||{},function(e){FOS.utils.textSnippetExpand=function(t,a,n){t=t||this,a=a||{};var s="FOS - Textarea Snippet Expand";if(apex.debug.info(s,a),n instanceof Function&&n.call(t,a),a&&a.dictionary&&a.stopChars){var i=[],l=[];a.stopChars.split(":").forEach((function(e){i.push(FOS.utils.textSnippetExpand.CHARS[e].key),l.push(FOS.utils.textSnippetExpand.CHARS[e].keyCode),"SPACE"===e&&i.push("Spacebar")}));for(let n=0;n<t.affectedElements.length;n++){let i=t.affectedElements[n],l=e(i).hasClass("rich_text_editor");l&&window.CKEDITOR?CKEDITOR.scriptLoader.load(a.automatchPluginUrl,(function(e){e?FOS.utils.textSnippetExpand.ckeditor4(i.id,a):console.error("Could not load automatch plugin")})):l&&window.ClassicEditor?console.warn(s):e(i).hasClass("text_field")||e(i).hasClass("textarea")?(i.removeEventListener("keydown",r),i.addEventListener("keydown",r),i.removeEventListener("keyup",o),i.addEventListener("keyup",o)):console.warn(s)}}function r(e){var t,n;if(null==e.key?(n=e.keyCode,t=l):(n=e.key,t=i),apex.debug.trace("Key ",e.key,e.keyCode,e.code),(90==e.which||90==e.keyCode)&&(e.ctrlKey||e.metaKey)&&this.dataset.lastReplaced&&this.dataset.lastKeystroke){var s=new RegExp(a.dictionary[this.dataset.lastReplaced]+this.dataset.lastKeystroke+"$");return s.test(this.value)&&(e.preventDefault(),this.value=this.value.replace(s,this.dataset.lastReplaced+this.dataset.lastKeystroke)),delete this.dataset.lastReplaced,void delete this.dataset.lastKeystroke}if(t.includes(n)){var r=function(e){var t,a;if(e.setSelectionRange)t=e.selectionStart,a=e.selectionEnd;else if(document.selection&&document.selection.createRange){var n=document.selection.createRange();a=(t=0-n.duplicate().moveStart("character",-1e5))+n.text.length}return{start:t,end:a}}(this),o=/\S+$/.exec(this.value.slice(0,r.end));if(o){var d=o[0];!function(e,t,n,s){var i=n-t,l=a.dictionary[s];if(!l)return;if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){e.createTextRange();rangctrl.collapse(!0),rangctrl.moveEnd("character",n),rangctrl.moveStart("character",t),rangctrl.select()}else e.selectionStart&&(e.selectionStart=t,e.selectionEnd=n);l&&(e.value=e.value.substring(0,t)+l+e.value.substr(n),e.setSelectionRange(n+l.length,n+l.length-i),e.dataset.lastReplaced=s)}(this,o.input.length-d.length,o.input.length,d)}}}function o(e){var t,a;null==e.key?(a=e.keyCode,t=l):(a=e.key,t=i),t.includes(a)?this.dataset.lastKeystroke=this.value.substr(-1):delete this.dataset.lastReplaced}},FOS.utils.textSnippetExpand.ckeditor4=function(e,t){let a=CKEDITOR.instances[e],n=t.stopChars.split(":").map((e=>FOS.utils.textSnippetExpand.CHARS[e].key));a.on("key",(function(e){var s=e.data.domEvent.$.key;if(-1!=n.indexOf(s)){var i=CKEDITOR.plugins.textMatch.match(a.getSelection().getRanges()[0],(function(e,t){var a=e.slice(0,t).split(/\s+/),n=a[a.length-1];return n?{start:e.lastIndexOf(n),end:t}:null}));if(i&&i.text){let e=t.dictionary[i.text];e&&a.insertHtml(e,"text",i.range)}}}))},FOS.utils.textSnippetExpand.CHARS={SPACE:{key:" ",keyCode:32},PERIOD:{key:".",keyCode:190},COMMA:{key:",",keyCode:188},ENTER:{key:"Enter",keyCode:13},TAB:{key:"Tab",keyCode:9},COLON:{key:":",keyCode:186},SEMICOLON:{key:";",keyCode:186},QUESTION:{key:"?",keyCode:191},EXCLAMATION:{key:"!",keyCode:49}}}(apex.jQuery);
//# sourceMappingURL=script.js.map

