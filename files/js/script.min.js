var FOS=window.FOS||{};FOS.utils=window.FOS.utils||{},FOS.utils.enableDragDrop=function(e,a,r){apex.debug.info("FOS - Enable Drag and Drop",a,r),r instanceof Function&&(r.call(e,a),apex.debug.info("Updated config by init-js-function",a)),FOS.utils.dragger=FOS.utils.dragger||{};let t,n=a.mode,o=a.simplePlaceholderColor||"#ccc",i=a.ajaxId,d=e.affectedElements[0].id,l=document.querySelector(`#${d} ${a.groupSelector}`),s=parseInt(a.distance);if(s=s==s?s:5,!l)return void apex.debug.error("Draggable Group not found - check your selector");t=a.dataIdFn instanceof Function?a.dataIdFn:function(e){return e.dataset.id};let c,g=Array.from(l.querySelectorAll(a.itemSelector)).map((e=>t(e))),p=e.resumeCallback;if(FOS.utils.dragger[d]&&FOS.utils.dragger[d].destroy(),apex.debug.info("init order",g),"swap"==n){let e,r,n,o,i;c=new Draggable.Swappable(l,{draggable:a.itemSelector,distance:s,plugins:[Draggable.Plugins.SwapAnimation],mirror:{constrainDimensions:!0}}),FOS.utils.dragger[d]=c,c.on("swappable:start",(a=>{e=t(a.data.dragEvent.originalSource),n=g.indexOf(e),o=n,i=[...g]})),c.on("swappable:swapped",(a=>{r=t(a.data.swappedElement),i=[...g];let d=i.indexOf(r),l=i[d];(n==o-1||n==o+1)&&(n>0&&g[n-1]==l||n<g.length-1&&g[n+1]==l)?i=g:(i[d]=e,i[n]=l),o=i.indexOf(e)})),c.on("swappable:stop",(e=>{for(let e=0;e<i.length;e++)if(i[e]!==g[e]){u({swapped:{dragId:i[e],dropId:g[e]},sequence:{before:g,after:i}}),g=i;break}}))}else c=new Draggable.Sortable(l,{draggable:a.itemSelector,plugins:[Draggable.Plugins.SortAnimation],handle:a.handle,distance:s,mirror:{constrainDimensions:!0}}),FOS.utils.dragger[d]=c,c.on("sortable:stop",(e=>{let a=e.data,r=a.newIndex,t=a.oldIndex,n=[...g];t!==r&&(!function(e,a,r,t=!1){t||(e=[...e]);let n=e[a];e.splice(a,1),e.splice(r,0,n)}(g,t,r,!0),u({sorted:{dragId:n[t],dropId:n[r]},sequence:{before:n,after:g}}))}));function u(r){if(apex.debug.info("Sequence updated",r),apex.event.trigger(e.affectedElements,"fos-enabledraganddrop-sequence-update",r),"plsql"===a.action){r.sequence.before=r.sequence.before.join(":"),r.sequence.after=r.sequence.after.join(":"),apex.server.plugin(i,{p_clob_01:JSON.stringify(r),pageItems:a.itemsToSubmit},{dataType:"json",target:e.browserEvent.target}).done((function(a){apex.event.trigger(e.affectedElements,"fos-enabledraganddrop-update-complete",r)})).fail((function(e,a,r){apex.da.handleAjaxErrors(e,a,r,p)}))}else"javascript"===a.action&&window[a.jsFn].call(this,r)}c.on("mirror:created",(e=>{let a=e.data.source;a.style.setProperty("background-color",o,"important"),Array.from(a.children).forEach((e=>{e.style.opacity=0}))}))};
//# sourceMappingURL=script.js.map

